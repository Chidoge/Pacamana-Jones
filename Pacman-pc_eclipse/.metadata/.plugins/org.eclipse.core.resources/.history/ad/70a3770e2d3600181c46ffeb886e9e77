package group23.pacman.view;

import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;

public class HelpScreenController {
	
	@FXML
	private ImageView background;
	
	public HelpScreenController() {
		
	}
	
	public void listenToKeyEvents() {
		
		scene.setOnKeyPressed(new EventHandler<KeyEvent>(){
		    @Override
		    public void handle(KeyEvent event) {
		    	/* Selects the currently shown map/level */
		    	if (event.getCode() == KeyCode.ENTER) {	
		    		if (!firstPress) {
			    		char level;
			    		switch (index) {
			    			case 0 :
			    				level = 'c';
			    				break;
			    			case 1 :
			   					level = 's';
			   					break;
			    			case 2 :
			    				level = 'd';
			    				break;
		    				default :
			    				level = 'c';
			    				break;
			    		}
			    		
			    		startGame(level);

		    		}
		    		else {
		    			firstPress = false;
		    		}
		    	}
		    	else if (event.getCode() == KeyCode.LEFT) {
		    		
		    		/* Prevents background from scrolling too fast if key is held down
		    		 * Only changes every half second */
					if (System.currentTimeMillis() - lastTime > 500) {
						lastTime = System.currentTimeMillis();
						setLeftBackground();
					}
					if (!animated) {
						animateLeft();
						animated = true;
					}

				}
				
				else if (event.getCode() == KeyCode.RIGHT) {
					
					/* Prevents background from scrolling too fast if key is held down
		    		 * Only changes every half second */
					if (System.currentTimeMillis() - lastTime > 500) {
						lastTime = System.currentTimeMillis();
						setRightBackground();
					}
					if (!animated) {
						animateRight();
						animated = true;
					}
				}
				
		    }	    
		});
		
		
		scene.setOnKeyReleased(new EventHandler<KeyEvent>(){
		    @Override
		    public void handle(KeyEvent event) {
		    	if (event.getCode() == KeyCode.LEFT) {
		    		resetLArrow();
		    		lastTime = 0;
		    		animated = false;
				}
				
				else if (event.getCode() == KeyCode.RIGHT) {
					resetRArrow();
		    		lastTime = 0;
		    		animated = false;
				}
		    }	    
		});
	}
	
	@FXML
	private void initialize() {
		
		/* Set up background of this view */
		Image backgroundImage = new Image("bg/help_screen_background");
		background.setImage(backgroundImage);

	}
}
